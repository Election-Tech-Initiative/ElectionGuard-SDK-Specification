module ElectionGuardConcrete = ElectionGuard where

import Encryption::SHA256

type q = 2^^256 - 189
type qhex = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF43

type p = 2^^4096 - 69*q - 2650872664557734482243044168410288960
type phex = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFbaFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFE0175E30B1B0E791DB502994F24DFB1

type r = (p - 1) / q
type g = 0x9B61C275E06F3E38372F9A9ADE0CDC4C82F4CE5337B3EF0ED28BEDBC01342EB89977C8116D741270D45B0EBE12D96C5AEE997FEFDEA18569018AFE1284E702BB9B8C78E03E697F378D25BCBCB94FEFD12B7F97047F63423268881C3B96B389E134CB3162CB73ED8052F7946C7E72907FD8B96862D443B5C26F7B0E3FDC9F035CBF0F5AAB670B79011A8BCDEBCF421CC9CBBE12C788E50328041EB59D81079497B667B96049DA04C79D60F527B1C02F7ECBA66849179CB5CFBE7C990CD888B69C44171E4F54C21A8CFE9D821F195F7553B73A705707263EAEA3B7AFA7DED79ACF5A64F3BFB939B815C52085F40714F4C6460B0B0C3598E31746A06C2A3457676CB345C8A390EBB9428CEECEFA6FCB1C27A9E527A6C55B8D6B2B1868D6EC719E189A799605C540F8641F135D5DC7FB62D58E0DE0B6AE3AB90E91FB996505D7D9283DA833FF0CB6CC8CA7BAFA0E90BB1ADB81545A801F0016DC7088A4DF2CFB7D6DD876A2A5807BDAA4000DAFA2DFB6FBB0ED9D775589156DDBFC24FF2203FFF9C5CF7C85C68F66DE94C98331F50FEF59CF8E7CE9D95FA008F7C1672D269C163751012826C4C8F5B5F4C11EDB62550F3CF93D86F3CC6E22B0E769AC659157F40383B5DF9DB9F8414F6CB5FA7D17BDDD3BC90DC7BDC39BAF3BE602A99E2A37CE3A5C098A8C1EFD3CD28A6B79306CA2C20C55174218A3935F697E813628D2D861BE54

type ginv = 1 / g

property qCorrect1 = (`q : Integer) == `qhex
property qCorrect2 = (`q : [4096])  == `qhex
property pCorrect1 = (`p : Integer) == `phex
property pCorrect2 = (`p : [4096])  == `phex
property gCorrect  = (`g : Z p)     == 2 ^^ `r

// The prime for the El Gamal multiplicative subgroup.
type Prime = p
type ExpModulus = q

// The total number of trustees in the election
type Trustees = 5

// The number of trustees necessary for decryption.
type Threshold = 3

// The generator for the El Gamal multiplicative subgroup.
type Generator = g

type elembits = 4096

type hashbits = 256

hash = SHA256Bit
